# OKX 实时交易分析器 - 交易功能使用说明

## 🚀 新功能介绍

本版本新增了**实盘交易功能**，可以根据技术分析信号自动执行买卖操作！

## ⚠️ 重要安全提示

**⚠️ 请在使用前仔细阅读以下安全须知：**

1. **实盘交易有风险，请谨慎使用**
2. **建议先在模拟环境（sandbox）测试**
3. **设置合理的交易金额和风险参数**
4. **定期监控交易状态**

## 📋 配置步骤

### 1. 获取 OKX API 密钥

1. 登录 [OKX交易所](https://www.okx.com)
2. 进入 "账户" → "API"
3. 创建新的API密钥：
   - **API Key**：复制保存
   - **Secret Key**：复制保存  
   - **Passphrase**：自定义密码短语
   - **权限**：勾选 "交易" 权限
   - **IP限制**：建议设置为您的IP地址

### 2. 配置交易参数

编辑 `trading_config.json` 文件：

```json
{
    "api_key": "YOUR_API_KEY_HERE",           // 替换为您的API Key
    "secret_key": "YOUR_SECRET_KEY_HERE",     // 替换为您的Secret Key  
    "passphrase": "YOUR_PASSPHRASE_HERE",     // 替换为您的Passphrase
    "sandbox": true,                          // true=模拟交易, false=实盘交易
    "trading_enabled": false,                 // 默认关闭交易，需在界面手动开启
    "trading_settings": {
        "trade_amount_usdt": 100,             // 每次交易金额(USDT)
        "min_trade_interval": 300,            // 最小交易间隔(秒)
        "max_trades_per_day": 5,              // 每日最大交易次数
        "stop_loss_percent": 5.0,             // 止损百分比
        "take_profit_percent": 10.0,          // 止盈百分比
        "risk_management": {
            "max_position_percent": 20,       // 最大持仓比例
            "max_drawdown_percent": 10        // 最大回撤比例
        }
    }
}
```

### 3. 测试配置

建议按以下顺序测试：

1. **模拟交易测试**：`"sandbox": true`
2. **小金额实盘测试**：`"trade_amount_usdt": 10`
3. **正式交易**：调整为合适的交易金额

## 🎮 界面操作

### 交易控制面板

在程序界面中找到"交易控制"面板：

- **启用实盘交易**：勾选后会弹出确认对话框
- **交易状态指示**：显示当前交易状态（🔴关闭/🟢开启）

### 交易状态面板

右侧显示实时交易信息：
- **交易状态**：最近的交易操作记录
- **持仓信息**：当前持有的币种
- **交易统计**：今日交易次数

## 📊 交易信号说明

### 买入信号条件（需全部满足）
1. **MACD金叉**且在零轴上方
2. **KDJ指标**：K>D且未超买
3. **RSI > 50**或从超卖区回升
4. **Williams %R > -50**或从超卖区向上
5. **价格在BBI上方**
6. **ZLMM动量为正值**

### 卖出信号条件（4个以上满足）
1. RSI超买 (>70)
2. KDJ超买 (K>80, D>80) 
3. Williams超买 (>-20)
4. MACD死叉
5. 价格偏离BBI > 5%
6. ZLMM动量转负

### 止损止盈机制
- **止损**：亏损达到设定百分比时自动卖出
- **止盈**：盈利达到设定百分比时自动卖出
- **检查频率**：每30秒检查一次

## ⚖️ 风险管理

### 内置安全机制
1. **交易间隔限制**：防止频繁交易
2. **每日交易限制**：控制交易次数
3. **余额检查**：确保有足够资金
4. **重复买入保护**：同一币种只持仓一次
5. **异常处理**：API错误时的安全保护

### 建议的风险参数
```json
"trading_settings": {
    "trade_amount_usdt": 50,      // 新手建议50-100 USDT
    "min_trade_interval": 600,    // 建议10分钟间隔
    "max_trades_per_day": 3,      // 建议每日3-5次
    "stop_loss_percent": 3.0,     // 建议3-5%止损
    "take_profit_percent": 8.0    // 建议8-15%止盈
}
```

## 📝 交易记录

程序会自动记录：
- 所有买卖操作
- 订单ID和执行价格
- 盈亏统计
- 信号强度评分

## 🔧 故障排除

### 常见问题

1. **"交易API未初始化"**
   - 检查 `trading_config.json` 文件是否存在
   - 确认API密钥格式正确

2. **"Order failed: Insufficient balance"**
   - 检查账户USDT余额
   - 降低 `trade_amount_usdt` 设置

3. **"Too soon to trade"**
   - 交易间隔限制，等待时间结束
   - 可在配置中调整 `min_trade_interval`

4. **连接失败**
   - 检查网络连接
   - 确认API权限设置正确
   - 验证IP白名单设置

### 日志查看

程序运行时会输出详细日志，包括：
- 交易执行结果
- API调用状态  
- 错误信息和原因

## 📞 技术支持

如有问题，请检查：
1. 配置文件格式是否正确
2. API密钥权限是否足够
3. 网络连接是否稳定
4. 账户余额是否充足

## ⚖️ 免责声明

- 本软件仅供学习和研究使用
- 交易有风险，投资需谨慎
- 使用者应自行承担所有交易风险
- 建议在充分了解市场风险后使用
- 不构成任何投资建议

---

**祝您交易顺利！** 🎯
